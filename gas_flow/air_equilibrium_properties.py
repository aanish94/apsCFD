#!/usr/bin/env python
# -*- coding: utf-8 -*-

"""Equilibrium Air Thermodynamic Properties
"""

from math import exp, log, log10

E0 = 78408.4e00
RHO0 = 1.292e00
P0 = 1.0133e05
T0 = 273.15e00
S0 = 6779.2e00
A0 = 331.3613e00
GASCONSTANT = 287.06e00

"""
P = Pressure (N/m/m)
RHO = Density (kg/m/m/m)
E = Specific Internal Energy (m^2/s^2)
H = Specific Enthalpy (m^2/s^2)
T = Temperature (K)
A = Speed of Sound (m/s)
S = Specific Entropy (m^2/s^2 - K)
"""


def a_from_p_s(p, s):
    """calculate speed of sound from pressure and entropy
    """

    X = log10(p / P0)
    Y = log10(s / GASCONSTANT)

    Z = X - Y

    h1 = 0
    h2 = 0
    h3 = 0
    h4 = 0
    h5 = 0
    h6 = 0
    h7 = 0
    h8 = 0
    h9 = 0
    h10 = 0
    h11 = 0
    h12 = 0
    h13 = 0
    h14 = 0
    h15 = 0
    h16 = 0
    h17 = 0
    h18 = 0
    h19 = 0
    h20 = 0
    h21 = 0
    h22 = 0
    h23 = 0
    h24 = 0
    h25 = 0

    # Table A16
    if Y > 2.10:

        h1 = -1.12793e02
        h2 = 1.35296e02
        h3 = 2.74295e00
        h4 = 0
        h5 = -4.08171e01
        h6 = -2.25652e-01
        h7 = -1.29257e00
        h8 = 0
        h9 = 0
        h10 = 0
        h11 = 2.57057e02
        h12 = -2.83199e02
        h13 = -5.84656e00
        h14 = 0
        h15 = 7.91574e01
        h16 = 3.35658e-01
        h17 = 2.17312e00
        h18 = 0
        h19 = 0
        h20 = 0
        h21 = 5.2614e01
        h22 = -3.0096e01
        h23 = -2.0e00
        h24 = 0
        h25 = 0

    elif Y >= 2.00:

        h1 = 7.02453e01
        h2 = -7.34732e01
        h3 = -5.86844e-01
        h4 = 0
        h5 = 1.95548e01
        h6 = 7.36786e-03
        h7 = 1.81521e-01
        h8 = 0
        h9 = 0
        h10 = 0
        h11 = -1.6961e01
        h12 = 1.90169e01
        h13 = -3.65779e-01
        h14 = 0
        h15 = -4.75063e00
        h16 = 2.01803e-02
        h17 = 1.07583e-01
        h18 = 0
        h19 = 0
        h20 = 0
        h21 = 2.65925e02
        h22 = -1.4142e02
        h23 = -5.0e00
        h24 = 0
        h25 = 0

    elif Y >= 1.90:

        h1 = -5.93554e00
        h2 = -7.79929e00
        h3 = -7.23618e00
        h4 = 3.31162e00
        h5 = 5.06381e00
        h6 = -5.377735e-01
        h7 = 0
        h8 = 2.46865e-01
        h9 = 0
        h10 = 0
        h11 = 3.9526e01
        h12 = -2.90994e01
        h13 = 6.24136e00
        h14 = -2.70007e00
        h15 = 5.42786e00
        h16 = 5.95235e-01
        h17 = 0
        h18 = -2.67771e-01
        h19 = 0
        h20 = 0
        h21 = 4.03352e01
        h22 = -2.73502e01
        h23 = -2.0e00
        h24 = 0
        h25 = 0

    elif Y >= 1.80:

        h1 = -6.60574e02
        h2 = 7.38042e02
        h3 = -8.77589e01
        h4 = 9.7894e01
        h5 = -2.06156e02
        h6 = -2.14028e-02
        h7 = -2.73753e01
        h8 = 0
        h9 = 0
        h10 = 0
        h11 = 6.65014e02
        h12 = -7.43416e02
        h13 = 8.87679e01
        h14 = -9.90508e01
        h15 = 2.08117e02
        h16 = 2.81148e-02
        h17 = 2.77374e01
        h18 = 0
        h19 = 0
        h20 = 0
        h21 = 1.17248e02
        h22 = -7.055e01
        h23 = -2.0e00
        h24 = 0
        h25 = 0

    elif Y >= 1.693:

        if Z > -1.917 * Y + 0.092:

            h1 = -4.73308e00
            h2 = 4.69363e00
            h3 = 9.43798e-02
            h4 = 3.54953e-03
            h5 = -7.98293e-01
            h6 = 2.02561e-02
            h7 = 0
            h8 = -8.73036e-03

        else:

            h1 = -8.042927e01
            h2 = 7.63739e01
            h3 = -9.381e00
            h4 = 5.72104e00
            h5 = -1.63435e01
            h6 = -7.48578e-01
            h7 = 0
            h8 = 4.50043e-01
            h9 = 0
            h10 = 0
            h11 = 8.34054e01
            h12 = -8.58837e01
            h13 = 4.84197e00
            h14 = -3.11188e00
            h15 = 2.11196e01
            h16 = 2.33945e-01
            h17 = 0
            h18 = -1.59099e-01
            h19 = 0
            h20 = 0
            h21 = 1.5138e01
            h22 = -1.5748e01
            h23 = 2.0e00
            h24 = 0
            h25 = 0

    elif Y >= 1.595:

        if Z > -9.842 * Y + 14.19:

            h1 = 3.37056e00
            h2 = -4.87016e00
            h3 = -3.85754e-01
            h4 = 2.87192e-01
            h5 = 2.02041e00
            h6 = -4.63144e-03
            h7 = 0
            h8 = 8.30832e-03

        else:

            h1 = -6.13548e01
            h2 = 7.80742e01
            h3 = 2.08524e00
            h4 = -1.21609e00
            h5 = -2.43686e01
            h6 = 8.77563e-02
            h7 = 0
            h8 = -5.46311e-02
            h9 = 0
            h10 = 0
            h11 = 2.07952e01
            h12 = -2.71591e01
            h13 = -7.43673e-01
            h14 = 4.08312e-01
            h15 = 8.68124e00
            h16 = -9.3593e-02
            h17 = 0
            h18 = 5.32328e-02
            h19 = 0
            h20 = 0
            h21 = 1.14314e02
            h22 = -7.757e01
            h23 = -2.0e00
            h24 = 0
            h25 = 0

    elif Y >= 1.40:

        h1 = 1.31057e02
        h2 = -2.88847e02
        h3 = -5.04887e00
        h4 = 7.73862e00
        h5 = 2.10147e02
        h6 = 5.48031e-02
        h7 = -2.88963e00
        h8 = -4.39459e-02
        h9 = -5.0396e01
        h10 = -2.10202e-04
        h11 = -1.33465e02
        h12 = 2.84739e02
        h13 = 7.57389e00
        h14 = -1.07749e01
        h15 = -2.02362e02
        h16 = -1.53453e-01
        h17 = 3.8313e00
        h18 = 1.08531e-01
        h19 = 4.79075e01
        h20 = 9.7931e-04
        h21 = -8.12685e02
        h22 = 1.304205e03
        h23 = 0
        h24 = -1.5e01
        h25 = -5.03745e02

    elif Y >= 1.23:

        h1 = -1.38377e-01
        h2 = -8.84138e00
        h3 = 2.61050e00
        h4 = -3.16535e00
        h5 = 1.10866e01
        h6 = -1.00224e-01
        h7 = 9.88389e-01
        h8 = 6.62193e-02
        h9 = -3.25761e00
        h10 = 8.20610e-04

    else:
        temp_val = log(1.4 * P0 / RHO0) + (log(p / P0) + (s - S0) / GASCONSTANT) / 3.5
        return exp(temp_val / 2.0)

    RLOG10 = h1 + h2 * Y + h3 * Z + h4 * Y * Z + h5 * (Y ** 2) + h6 * (Z ** 2) + h7 * (Y ** 2) * Z + h8 * Y * (Z ** 2) + h9 * (Y ** 3) + h10 * (Z ** 3) + (h11 + h12 * Y + h13 * Z + h14 * Y * Z + h15 * (Y **2) + h16 * (Z ** 2) + h17 * (Y ** 2) * Z + h18 * Y * (Z ** 2) + h19 * (Y ** 3) + h20 * (Z ** 3)) / (1 + exp(h21 + h22 * Y + h23 * Z + h24 * X + h25 * (Y ** 2)))

    rho = (10 ** RLOG10) * A0

    return rho


def h_from_p_rho(p, rho):
    pass

    Y = log10(rho / RHO0)
    X = log10(p / P0)

    Z = X - Y
#
#    if Y > 3.0:
#        raise ValueError("Bad Y: {}".format(Y))

    # Table A9
    if Y > -0.5:

        if Z > 1.60:

            sign = 1
            c1 = 9.21537e-01
            c2 = -2.39670e-01
            c3 = 1.30714e00
            c4 = 3.4299e-01
            c5 = -2.18847e-02
            c6 = -1.20916e00
            c7 = 1.36691e-02
            c8 = -1.10206e-01
            c9 = -4.90274e-04
            c10 = 3.087920e-01
            c11 = -6.77089e00
            c12 = -6.90476e-02
            c13 = 8.18168e00
            c14 = -9.52708e-02
            c15 = 2.98487e-02
            c16 = -3.07662e00
            c17 = -1.78706e-02
            c18 = 6.60408e-02
            c19 = 6.28419e-04
            c20 = 3.38590e-01
            c21 = 1.5916669e02
            c22 = 3.976192e01
            c23 = -7.966199e01
            c24 = -1.66667e01

        elif Z > 1.05:

            sign = 1
            c1 = -2.67593e-01
            c2 = -1.87457e-01
            c3 = 5.07693e00
            c4 = 2.72286e-01
            c5 = 1.04541e-02
            c6 = -5.0852e00
            c7 = -1.42211e-02
            c8 = -7.81935e-02
            c9 = 6.3892e-04
            c10 = 1.58711e00
            c11 = 2.87969e00
            c12 = 3.9009e-01
            c13 = -8.06179e00
            c14 = -5.5125e-01
            c15 = -1.01903e-02
            c16 = 7.29592e00
            c17 = 1.35906e-02
            c18 = 1.83861e-01
            c19 = -8.97772e-04
            c20 = -2.15153e00
            c21 = 1.828573e02
            c22 = -3.428596e01
            c23 = -1.51786e02
            c24 = 2.976212e01

        elif Z > 0.10:

            sign = -1
            c1 = -9.67488e01
            c2 = 2.05296e-01
            c3 = 2.69927e02
            c4 = -1.92887e00
            c5 = 3.78392e-01
            c6 = -2.46711e02
            c7 = -3.23965e-01
            c8 = 1.54416e00
            c9 = -3.61036e-03
            c10 = 7.48760e01
            c11 = 9.81502e01
            c12 = -2.05448e-01
            c13 = -2.69913e02
            c14 = 1.93052e00
            c15 = -3.78527e-01
            c16 = 2.46630e02
            c17 = 3.24832e-01
            c18 = -1.54646e00
            c19 = 3.66182e-03
            c20 = -7.4898e01
            c21 = -2.659865e01
            c22 = 1.564631e00
            c23 = 2.312926e01
            c24 = -1.360543e00

        else:

            sign = 1
            c1 = 1.4017e00
            c2 = 0
            c3 = 0
            c4 = 0
            c5 = 0
            c6 = 0
            c7 = 0
            c8 = 0
            c9 = 0
            c10 = 0
            c11 = 0
            c12 = 0
            c13 = 0
            c14 = 0
            c15 = 0
            c16 = 0
            c17 = 0
            c18 = 0
            c19 = 0
            c20 = 0
            c21 = 0
            c22 = 0
            c23 = 0
            c24 = 0

    # Table A8
    elif Y > -4.5:

        if Z > 2.00:

            sign = 1
            c1 = -3.77766e00
            c2 = -5.53738e-01
            c3 = 6.60834e00
            c4 = 4.87181e-01
            c5 = -2.11045e-02
            c6 = -2.94754e00
            c7 = 9.67277e-03
            c8 = -1.02365e-01
            c9 = -2.1942e-04
            c10 = 4.3962e-01
            c11 = 4.05813e01
            c12 = 3.25692e00
            c13 = -4.79583e01
            c14 = -2.53660e00
            c15 = 9.06436e-02
            c16 = 1.8904e01
            c17 = -3.47578e-02
            c18 = 4.94114e-01
            c19 = 1.00077e-03
            c20 = -2.48554e00
            c21 = 5.34718e02
            c22 = 7.495657e01
            c23 = -2.219822e02
            c24 = -3.017229e01

        elif Z > 1.50:

            sign = 1
            c1 = 4.31520e-01
            c2 = -2.83857e-01
            c3 = 2.27791e00
            c4 = 3.99159e-01
            c5 = -1.29444e-02
            c6 = -1.84314e00
            c7 = 8.78723e-03
            c8 = -1.28136e-01
            c9 = -1.60583e-04
            c10 = 4.45362e-01
            c11 = -1.03883e01
            c12 = -3.58718e-01
            c13 = 1.35068e01
            c14 = 1.87268e-01
            c15 = -4.28184e-03
            c16 = -5.63894e00
            c17 = -9.52016e-04
            c18 = -1.45625e-03
            c19 = -4.10506e-05
            c20 = 7.39915e-01
            c21 = 2.949221e02
            c22 = 1.36866e01
            c23 = -1.559335e02
            c24 = -3.78776e00

        elif Z > 0.95:

            sign = 1
            c1 = -7.36684e00
            c2 = -1.13247e00
            c3 = 2.47879e01
            c4 = 1.99625e00
            c5 = -4.91630e-02
            c6 = -2.3299e01
            c7 = 4.16673e-02
            c8 = -8.59418e-01
            c9 = -6.58149e-04
            c10 = 7.19016e00
            c11 = -2.42647e00
            c12 = 5.57912e-01
            c13 = -2.03055e00
            c14 = -1.22031e00
            c15 = 3.74866e-02
            c16 = 7.75414e00
            c17 = -3.39278e-02
            c18 = 6.08488e-01
            c19 = 5.21042e-04
            c20 = -3.68326e00
            c21 = 8.077385e01
            c22 = -1.273807e01
            c23 = -6.547623e01
            c24 = 1.190475e01

        elif Z > 0.10:

            sign = -1
            c1 = -1.33083e02
            c2 = -9.98707e00
            c3 = 3.94734e02
            c4 = 2.35810e01
            c5 = 1.43957e00
            c6 = -3.84712e02
            c7 = -1.43175e00
            c8 = -1.36367e01
            c9 = 1.77068e-05
            c10 = 1.24325e02
            c11 = 1.34486e02
            c12 = 9.99122e00
            c13 = -3.94719e02
            c14 = -2.35853e01
            c15 = -1.43799e00
            c16 = 3.84616e02
            c17 = 1.43039e00
            c18 = 1.36318e01
            c19 = 1.44367e-04
            c20 = -1.24348e02
            c21 = -2.141444e01
            c22 = 1.381584e00
            c23 = 2.039473e01
            c24 = -1.315789e00

        else:

            sign = 1
            c1 = 1.399e00
            c2 = 0
            c3 = 0
            c4 = 0
            c5 = 0
            c6 = 0
            c7 = 0
            c8 = 0
            c9 = 0
            c10 = 0
            c11 = 0
            c12 = 0
            c13 = 0
            c14 = 0
            c15 = 0
            c16 = 0
            c17 = 0
            c18 = 0
            c19 = 0
            c20 = 0
            c21 = 0
            c22 = 0
            c23 = 0
            c24 = 0

    # Table A7
    elif Y >= -7.0:

        if Z > 1.95:

            sign = 1
            c1 = -8.32595e00
            c2 = -3.50219e-01
            c3 = 1.36455e01
            c4 = 3.59350e-01
            c5 = -3.70109e-03
            c6 = -6.49007e00
            c7 = 3.30836e-03
            c8 = -8.38594e-02
            c9 = 1.10018e-04
            c10 = 1.02443e00
            c11 = -3.08441e01
            c12 = -1.4951e00
            c13 = 3.00585e01
            c14 = 9.19650e-01
            c15 = -3.60024e-02
            c16 = -9.33522e00
            c17 = 1.02522e-02
            c18 = -1.35228e-01
            c19 = -4.68760e-04
            c20 = 8.92634e-01
            c21 = 8.800047e01
            c22 = -1.679356e01
            c23 = -3.333353e01
            c24 = 8.465574e00

        elif Z > 1.30:

            sign = 1
            c1 = 6.17584e-01
            c2 = -2.40690e-01
            c3 = 1.95904e00
            c4 = 3.41644e-01
            c5 = -1.01073e-02
            c6 = -1.68951e00
            c7 = 6.77631e-03
            c8 = -1.10932e-01
            c9 = -1.15922e-04
            c10 = 4.26058e-01
            c11 = -1.34222e01
            c12 = -5.43713e-01
            c13 = 1.81528e01
            c14 = 3.95928e-01
            c15 = -7.41105e-03
            c16 = -7.97425e00
            c17 = 1.67768e-03
            c18 = -5.80593e-02
            c19 = -3.32714e-06
            c20 = 1.12448e00
            c21 = 8.677803e01
            c22 = -8.370349e00
            c23 = -4.074084e01
            c24 = 7.407405e00

        elif Z > 0.85:

            sign = 1
            c1 = -1.05745e01
            c2 = -1.93693e00
            c3 = 3.07202e01
            c4 = 3.35578e00
            c5 = -7.79965e-02
            c6 = -2.60637e01
            c7 = 6.68790e-02
            c8 = -1.42391e00
            c9 = -9.86882e-04
            c10 = 7.23223e00
            c11 = -1.86342e01
            c12 = 2.41997e-02
            c13 = 3.20880e01
            c14 = -7.46914e-01
            c15 = 3.75161e-02
            c16 = -1.69985e01
            c17 = -4.10125e-02
            c18 = 5.39041e-01
            c19 = 5.74637e-04
            c20 = 2.56253e00
            c21 = 2.768567e02
            c22 = 2.152383e01
            c23 = -2.164837e02
            c24 = -1.394837e01

        elif Z > 0.10:

            sign = -1
            c1 = 2.53908e02
            c2 = 1.01491e02
            c3 = -3.87199e02
            c4 = -1.54304e02
            c5 = 7.28532e00
            c6 = 9.86233e01
            c7 = -8.04378e00
            c8 = 4.63763e01
            c9 = -1.82577e-03
            c10 = 2.18994e01
            c11 = -2.52423e02
            c12 = -1.01445e02
            c13 = 3.87210e02
            c14 = 1.54298e02
            c15 = -7.2773e00
            c16 = -9.87576e01
            c17 = 8.04277e00
            c18 = -4.63883e01
            c19 = 2.28399e-03
            c20 = -2.19438e01
            c21 = -11.0e00
            c22 = 2.0e00
            c23 = 11.0e00
            c24 = -2.0e00

        else:

            sign = 1
            c1 = 1.3986e00
            c2 = 0
            c3 = 0
            c4 = 0
            c5 = 0
            c6 = 0
            c7 = 0
            c8 = 0
            c9 = 0
            c10 = 0
            c11 = 0
            c12 = 0
            c13 = 0
            c14 = 0
            c15 = 0
            c16 = 0
            c17 = 0
            c18 = 0
            c19 = 0
            c20 = 0
            c21 = 0
            c22 = 0
            c23 = 0
            c24 = 0

    else:
        raise ValueError("Bad Y: {}".format(Y))

    gamma = c1 + c2 * Y + c3 * Z + c4 * Y * Z + c5 * (Y ** 2) + c6 * (Z ** 2) + c7 * (Y ** 2) * Z + c8 * Y * (Z ** 2) + c9 * (Y ** 3) + c10 * (Z ** 3) + (c11 + c12 * Y + c13 * Z + c14 * Y * Z + c15 * (Y **2) + c16 * (Z ** 2) + c17 * (Y ** 2) * Z + c18 * Y * (Z ** 2) + c19 * (Y ** 3) + c20 * (Z ** 3)) / (1 + sign * exp(c21 + c22 * Y + c23 * Z + c24 * Y * Z))

    H = (p / rho) * (gamma / (gamma - 1))

    return H


def rho_from_p_s(p, s):
    """calculate density from pressure and entropy
    """

    X = log10(p / P0)
    Y = log10(s / GASCONSTANT)

    Z = X - Y

    f1 = 0
    f2 = 0
    f3 = 0
    f4 = 0
    f5 = 0
    f6 = 0
    f7 = 0
    f8 = 0
    f9 = 0
    f10 = 0
    f11 = 0
    f12 = 0
    f13 = 0
    f14 = 0
    f15 = 0
    f16 = 0
    f17 = 0
    f18 = 0
    f19 = 0
    f20 = 0
    f21 = 0
    f22 = 0
    f23 = 0
    f24 = 0
    f25 = 0

    # Table A14
    if Y > 2.10:

        f1 = 1.86938e02
        f2 = -1.45261e02
        f3 = 2.23883e01
        f4 = -1.04974e01
        f5 = 2.60284e01
        f6 = 1.85949e00
        f7 = 0
        f8 = -8.98218e-01
        f9 = 0
        f10 = 0
        f11 = -1.27867e02
        f12 = 8.58453e01
        f13 = -2.28808e01
        f14 = 1.13034e01
        f15 = -1.1234e01
        f16 = -1.56005e00
        f17 = 0
        f18 = 7.79397e-01
        f19 = 0
        f20 = 0
        f21 = 5.2614e01
        f22 = -3.0096e01
        f23 = -2.0e00
        f24 = 0
        f25 = 0

    elif Y >= 2.00:

        f1 = -3.62767e01
        f2 = 3.8634e01
        f3 = 1.48507e00
        f4 = -3.41824e-01
        f5 = -1.04718e01
        f6 = -3.25437e-02
        f7 = 0
        f8 = 1.22032e-02
        f9 = 0
        f10 = 0
        f11 = 6.5292e01
        f12 = -6.28154e01
        f13 = 2.10906e00
        f14 = -1.11759e00
        f15 = 1.50026e01
        f16 = 2.71716e-01
        f17 = 0
        f18 = -1.4431e-01
        f19 = 0
        f20 = 0
        f21 = 2.65925e02
        f22 = -1.4142e02
        f23 = -5.0e00
        f24 = 0
        f25 = 0

    elif Y >= 1.90:

        f1 = 1.40088e01
        f2 = -1.58855e01
        f3 = 1.71245e-01
        f4 = 4.32352e-01
        f5 = 4.42836e00
        f6 = -9.54417e-03
        f7 = 0
        f8 = 8.92335e-03
        f9 = 0
        f10 = 0
        f11 = -1.13217e02
        f12 = 1.24304e02
        f13 = 4.41505e00
        f14 = -2.4853e00
        f15 = -3.42370e01
        f16 = -7.84297e-02
        f17 = 0
        f18 = 1.21459e-02
        f19 = 0
        f20 = 0
        f21 = 7.308e01
        f22 = -4.1768e01
        f23 = -2.0e00
        f24 = 0
        f25 = 0

    elif Y >= 1.80:

        f1 = 6.23124e02
        f2 = -6.77571e02
        f3 = 9.12811e01
        f4 = -9.55480e01
        f5 = 1.84603e02
        f6 = 6.97635e-01
        f7 = 2.54274e01
        f8 = -3.27916e-01
        f9 = 0
        f10 = 4.90838e-03
        f11 = -6.39514e02
        f12 = 6.97458e02
        f13 = -1.00154e02
        f14 = 1.06701e02
        f15 = -1.90745e02
        f16 = -4.81471e-01
        f17 = -2.86323e01
        f18 = 2.00348e-01
        f19 = 0
        f20 = -6.43371e-03
        f21 = 1.17248e02
        f22 = -7.055e01
        f23 = -2.0e00
        f24 = 0
        f25 = 0

    elif Y >= 1.70:

        if Z >= 7.5269 * Y - 14.9366:

            f1 = -2.99578e01
            f2 = 3.89998e01
            f3 = 2.90256e00
            f4 = -1.25088e00
            f5 = -1.26641e01
            f6 = 6.13867e-02
            f7 = 0
            f8 = -5.17059e-02
            f9 = 0
            f10 = 0
            f11 = 6.05677e01
            f12 = -7.08307e01
            f13 = -2.95622e00
            f14 = 1.70504e00
            f15 = 2.07549e01
            f16 = -2.70962e-01
            f17 = 0
            f18 = 1.80057e-01
            f19 = 0
            f20 = 0
            f21 = 5.8278e01
            f22 = -3.3644e01
            f23 = -2.0e00
            f24 = 0
            f25 = 0

        else:

            f1 = 6.22639e01
            f2 = -7.8884e01
            f3 = -2.19123e00
            f4 = 1.84533e00
            f5 = 2.48413e01
            f6 = -8.76105e-02
            f7 = 0
            f8 = 5.55047e-02
            f9 = 0
            f10 = 0
            f11 = -7.28463e01
            f12 = 9.42375e01
            f13 = 4.04979e00
            f14 = -2.45467e00
            f15 = -3.02865e01
            f16 = 1.2872e-01
            f17 = 0
            f18 = -8.63721e-02
            f19 = 0
            f20 = 0
            f21 = 3.672e01
            f22 = -2.69152e01
            f23 = -2.0e00
            f24 = 0
            f25 = 0

    elif Y >= 1.592:

        if Z >= 7.5269 * Y - 14.9366:

            f1 = 3.97149e01
            f2 = -4.80988e01
            f3 = -1.17821e00
            f4 = 1.27522e00
            f5 = 1.45552e01
            f6 = -2.50279e-01
            f7 = 0
            f8 = 1.58399e-01
            f9 = 0
            f10 = 0
            f11 = -5.01859e01
            f12 = 6.31564e01
            f13 = 2.39925e00
            f14 = -1.47883e00
            f15 = -1.98852e01
            f16 = 4.66791e-01
            f17 = 0
            f18 = -3.06926e-01
            f19 = 0
            f20 = 0
            f21 = 3.6406e01
            f22 = -2.232e01
            f23 = -2.0e00
            f24 = 0
            f25 = 0

        else:

            f1 = 1.10732e02
            f2 = -1.33968e02
            f3 = 3.7583e-01
            f4 = 2.77887e-01
            f5 = 4.03018e01
            f6 = 1.18506e-01
            f7 = 0
            f8 = -6.98812e-02
            f9 = 0
            f10 = 0
            f11 = -6.85292e01
            f12 = 8.23834e01
            f13 = -1.24942e00
            f14 = 8.31615e-01
            f15 = -2.452e01
            f16 = -1.13019e-01
            f17 = 0
            f18 = 7.46719e-02
            f19 = 0
            f20 = 0
            f21 = 9.9318e01
            f22 = -6.7952e01
            f23 = -2.0e00
            f24 = 0
            f25 = 0

    elif Y >= 1.42:

        f1 = -2.78074e02
        f2 = 6.11791e02
        f3 = 1.37528e01
        f4 = -1.92394e01
        f5 = -4.42909e02
        f6 = -1.97269e-01
        f7 = 7.10425e00
        f8 = 1.49708e-01
        f9 = 1.05869e02
        f10 = 1.19153e-03
        f11 = 2.80393e02
        f12 = -5.95834e02
        f13 = -1.75934e01
        f14 = 2.49706e01
        f15 = 4.21767e02
        f16 = 3.61896e-01
        f17 = -8.85461e00
        f18 = -2.55458e-01
        f19 = -9.94515e01
        f20 = -2.96892e-03
        f21 = -8.12685e02
        f22 = 1.304205e03
        f23 = 0
        f24 = -1.5e01
        f25 = -5.03745e02

    elif Y >= 1.23:

        f1 = -1.72119e01
        f2 = 5.49354e01
        f3 = -1.99776e00
        f4 = 3.17884e00
        f5 = -4.69831e01
        f6 = 1.58567e-01
        f7 = -8.66580e-01
        f8 = -1.03055e-01
        f9 = 1.21069e01
        f10 = -1.52322e-03

    else:
        temp_val = (log(p / P0) / 1.40) - (s - S0) / (3.5 * GASCONSTANT)
        return RHO0 * exp(temp_val)

    RLOG10 = f1 + f2 * Y + f3 * Z + f4 * Y * Z + f5 * (Y ** 2) + f6 * (Z ** 2) + f7 * (Y ** 2) * Z + f8 * Y * (Z ** 2) + f9 * (Y ** 3) + f10 * (Z ** 3) + (f11 + f12 * Y + f13 * Z + f14 * Y * Z + f15 * (Y **2) + f16 * (Z ** 2) + f17 * (Y ** 2) * Z + f18 * Y * (Z ** 2) + f19 * (Y ** 3) + f20 * (Z ** 3)) / (1 + exp(f21 + f22 * Y + f23 * Z + f24 * X + f25 * (Y ** 2)))

    rho = (10 ** RLOG10) * RHO0

    return rho


def T_from_p_rho(p, rho):
    """Calculate Temperature from pressure and density
    """

    Y = log10(rho / RHO0)
    X = log10(p / P0)

    Z = X - Y

    T_DEFAULT = p / (rho * GASCONSTANT)

    if Y > 3.0:
        raise ValueError("Bad Y: {}".format(Y))

    # Table A12
    elif Y > -0.5:
        pass

        if Z > 1.45:

            d1 = -1.66249e00
            d2 = -8.91113e-02
            d3 = 4.11648e00
            d4 = 8.78093e-02
            d5 = -3.09742e-03
            d6 = -1.84445e00
            d7 = 1.99879e-03
            d8 = -7.50324e-03
            d9 = 6.85472e-05
            d10 = 3.05784e-01
            d11 = 1.11555e01
            d12 = 1.3210e00
            d13 = -1.71236e01
            d14 = -1.2919e00
            d15 = 6.28124e-02
            d16 = 8.63804e00
            d17 = -3.07949e-02
            d18 = 3.07809e-01
            d19 = 1.57743e-03
            d20 = -1.42634e00
            d21 = 1.33061e02
            d22 = 8.979635e00
            d23 = -7.265298e01
            d24 = -2.449009e00

        elif Z > 1.00:

            d1 = 8.06492e-01
            d2 = 9.91293e-02
            d3 = -1.70742e00
            d4 = -2.28264e-01
            d5 = 5.03500e-03
            d6 = 3.02351e00
            d7 = -6.13927e-03
            d8 = 1.31574e-01
            d9 = 1.69824e-04
            d10 = -1.12755e00
            d11 = -1.17930e-01
            d12 = -2.12207e-01
            d13 = 1.3654e00
            d14 = 4.05886e-01
            d15 = -1.88260e-02
            d16 = -2.10926e00
            d17 = 1.65486e-02
            d18 = -1.89881e-01
            d19 = -5.1140e-04
            d20 = 8.79806e-01
            d21 = 1.959604e02
            d22 = -4.269391e01
            d23 = -1.734931e02
            d24 = 3.762898e01

        elif Z > 0.25:

            d1 = -1.54141e-03
            d2 = 6.58337e-04
            d3 = 9.82201e-01
            d4 = -3.85028e-03
            d5 = 1.23111e-04
            d6 = 3.77441e-02
            d7 = -4.08210e-04
            d8 = 4.56963e-03
            d9 = 2.13592e-05
            d10 = -2.35172e-02
            d11 = 0
            d12 = 0
            d13 = 0
            d14 = 0
            d15 = 0
            d16 = 0
            d17 = 0
            d18 = 0
            d19 = 0
            d20 = 0
            d21 = 0
            d22 = 0
            d23 = 0
            d24 = 0

        else:
            return T_DEFAULT

    # Table A11
    elif Y > -4.5:
        pass

        if Z > 2.05:

            d1 = -1.27244e01
            d2 = -1.66684e00
            d3 = 1.72708e01
            d4 = 1.45307e00
            d5 = -3.64515e-02
            d6 = -6.97208e00
            d7 = 1.90463e-02
            d8 = -3.04323e-01
            d9 = 4.80787e-04
            d10 = 9.67524e-01
            d11 = 7.71330e00
            d12 = 5.0834e-01
            d13 = -9.8211e00
            d14 = -4.49138e-01
            d15 = -9.41787e-04
            d16 = 4.16530e00
            d17 = -2.40293e-03
            d18 = 9.63923e-02
            d19 = -8.28450e-04
            d20 = -5.88807e-01
            d21 = -1.092654e03
            d22 = -3.05312e02
            d23 = 4.656243e02
            d24 = 1.312498e02

        elif Z > 1.45:

            d1 = -1.23779e01
            d2 = -1.14728e00
            d3 = 2.41382e01
            d4 = 1.38957e00
            d5 = -3.63693e-02
            d6 = -1.42844e01
            d7 = 2.24265e-02
            d8 = -4.06553e-01
            d9 = -3.23888e-04
            d10 = 2.8762e00
            d11 = 4.40782e00
            d12 = 1.33046e00
            d13 = -1.15405e01
            d14 = -1.59892e00
            d15 = 5.30580e-02
            d16 = 8.57309e00
            d17 = -3.10376e-02
            d18 = 4.71274e-01
            d19 = 4.77650e-04
            d20 = -1.96233e00
            d21 = 1.4075e02
            d22 = -6.499992e00
            d23 = -7.75e01
            d24 = 5.0e00

        elif Z > 0.95:

            d1 = -5.12404e00
            d2 = -2.8474e-01
            d3 = 1.54532e01
            d4 = 4.52475e-01
            d5 = -1.22881e-02
            d6 = -1.35181e01
            d7 = 8.56845e-03
            d8 = -1.68725e-01
            d9 = -3.25256e-04
            d10 = 4.18451e00
            d11 = 7.52564e00
            d12 = 8.35238e-01
            d13 = -1.955558e01
            d14 = -1.23393e00
            d15 = 3.34510e-02
            d16 = 1.71779e01
            d17 = -2.34269e-02
            d18 = 4.54628e-01
            d19 = 4.81788e-04
            d20 = -5.09936e00
            d21 = 6.148442e01
            d22 = -1.828123e01
            d23 = -5.468755e01
            d24 = 1.562500e01

        elif Z > 0.25:

            d1 = 2.03910e-02
            d2 = 7.67310e-03
            d3 = 8.48581e-01
            d4 = -2.93086e-02
            d5 = 8.40269e-04
            d6 = 2.67251e-01
            d7 = -1.47701e-03
            d8 = 2.37262e-02
            d9 = 3.13687e-05
            d10 = -1.41973e-01
            d11 = 0
            d12 = 0
            d13 = 0
            d14 = 0
            d15 = 0
            d16 = 0
            d17 = 0
            d18 = 0
            d19 = 0
            d20 = 0
            d21 = 0
            d22 = 0
            d23 = 0
            d24 = 0
        else:
            return T_DEFAULT

    # Table A10
    elif Y >= - 7.0:
        pass

        if Z > 1.95:

            d1 = -2.33271e01
            d2 = -1.89958e00
            d3 = 3.21440e01
            d4 = 1.68622e00
            d5 = -4.42123e-02
            d6 = -1.38645e01
            d7 = 2.82629e-02
            d8 = -3.40976e-01
            d9 = 6.63272e-04
            d10 = 2.04466e00
            d11 = 8.35474e00
            d12 = 1.71347e00
            d13 = -1.60715e01
            d14 = -1.63139e00
            d15 = 4.14641e-02
            d16 = 8.70275e00
            d17 = -2.30068e-02
            d18 = 3.60966e-01
            d19 = 1.53246e-05
            d20 = -1.46166e00
            d21 = 1.115884e02
            d22 = -6.452606e00
            d23 = -5.337863e01
            d24 = 2.026986e00

        elif Z > 1.40:

            d1 = -1.98573e01
            d2 = -1.67225e00
            d3 = 3.76159e01
            d4 = 2.10964e00
            d5 = -3.40174e-02
            d6 = -2.22215e01
            d7 = 2.31712e-02
            d8 = -6.44596e-01
            d9 = -9.80275e-05
            d10 = 4.40486e00
            d11 = -5.36809e00
            d12 = 2.41201e-01
            d13 = -1.25881e00
            d14 = -8.62744e-01
            d15 = -3.79774e-03
            d16 = 5.58609e00
            d17 = -7.81335e-03
            d18 = 3.78963e-01
            d19 = -3.80005e-04
            d20 = -1.81566e00
            d21 = 2.08e01
            d22 = -2.56e01
            d23 = 1.0e00
            d24 = 1.80e01

        elif Z > 0.95:

            d1 = -8.12952e00
            d2 = -8.28637e-01
            d3 = 2.26904e01
            d4 = 1.41132e00
            d5 = -2.98633e-02
            d6 = -1.91806e01
            d7 = 2.70066e-02
            d8 = -5.78875e-01
            d9 = -2.28103e-04
            d10 = 5.62580e00
            d11 = -3.99845e00
            d12 = 2.26369e-01
            d13 = 2.52870e00
            d14 = -7.28448e-01
            d15 = 1.09769e-02
            d16 = 2.99238e00
            d17 = -1.83819e-02
            d18 = 3.91440e-01
            d19 = -1.51380e-04
            d20 = -2.04463e00
            d21 = -3.887015e01
            d22 = -2.908228e01
            d23 = 4.070557e01
            d24 = 2.682347e01

        elif Z > 0.25:

            d1 = 1.23718e-01
            d2 = 1.08623e-02
            d3 = 2.24239e-01
            d4 = -8.24608e-02
            d5 = -1.17615e-03
            d6 = 1.18397e00
            d7 = -1.87566e-03
            d8 = 6.4852e-02
            d9 = -1.19155e-04
            d10 = -5.52634e-01
            d11 = 0
            d12 = 0
            d13 = 0
            d14 = 0
            d15 = 0
            d16 = 0
            d17 = 0
            d18 = 0
            d19 = 0
            d20 = 0
            d21 = 0
            d22 = 0
            d23 = 0
            d24 = 0

        else:
            return T_DEFAULT
    else:
        raise ValueError("Bad Y: {}".format(Y))

    TLOG10 = d1 + d2 * Y + d3 * Z + d4 * Y * Z + d5 * (Y ** 2) + d6 * (Z ** 2) + d7 * (Y ** 2) * Z + d8 * Y * (Z ** 2) + d9 * (Y ** 3) + d10 * (Z ** 3) + (d11 + d12 * Y + d13 * Z + d14 * Y * Z + d15 * (Y **2) + d16 * (Z ** 2) + d17 * (Y ** 2) * Z + d18 * Y * (Z ** 2) + d19 * (Y ** 3) + d20 * (Z ** 3)) / (1 + exp(d21 + d22 * Y + d23 * Z + d24 * Y * Z))

    T = (10 ** TLOG10) * T0

    return T
